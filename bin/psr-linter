#!/usr/bin/env php

<?php

require_once __DIR__ . '/../vendor/autoload.php';

use \Commando\Command;
use function \PsrLinter\lintCli;

$cmd = new Command();

$cmd->option()
    ->require(true)
    ->describedAs('One or more files and/or directories to check')
    ->expectsFile();
$cmd->flag('fix')
    ->describedAs('fix violations')
    ->boolean();
$cmd->flag('report-file')
    ->describedAs('Save report to file. STDERR suppressed in case of no violations');
$cmd->flag('report-format')
    ->must(function ($format) {
        return in_array($format, ['text', 'json', 'yaml']);
    })
    ->describedAs("Report format: 'text', 'json' and 'yaml' avilable");
$cmd->setHelp("Validate php files according PSR2 standards\n\n" .
              "Usage: psr-linter file [--fix] [--report-file file] [--report-format format]");

exit(lintCli($cmd[0], $cmd->getFlagValues()));
